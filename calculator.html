
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Home Security Calculator</title>

<style>
:root {
  --primary:#0b1c2d;
  --accent:#2563eb;
  --bg:#f7f9fb;
  --text:#1f2937;
  --radius:10px;
}

body {
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}

.calculator {
  max-width:1200px;
  margin:auto;
  padding:24px;
}

h1,h2 {
  color:var(--primary);
}

.section {
  margin-top:30px;
}

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:14px;
}

label {
  font-size:14px;
  font-weight:600;
}

select,input {
  width:100%;
  padding:10px;
  border-radius:var(--radius);
  border:1px solid #ccc;
  font-size:14px;
}

.totals {
  margin-top:30px;
  background:var(--primary);
  color:#fff;
  padding:20px;
  border-radius:var(--radius);
  display:flex;
  justify-content:space-between;
  flex-direction:column;
  gap:10px;
}

.total-box {
  display:flex;
  justify-content:space-between;
  font-size:18px;
  font-weight:bold;
}

.total-value {
  font-size:24px;
}

.device-summary {
  font-size:14px;
  background:rgba(255,255,255,0.15);
  padding:10px;
  border-radius:var(--radius);
  max-height:120px;
  overflow-y:auto;
}

button {
  width:100%;
  padding:14px;
  margin-top:20px;
  background:var(--accent);
  color:#fff;
  border:none;
  border-radius:var(--radius);
  font-size:16px;
  cursor:pointer;
}

.card-box {
  background:#fff;
  padding:20px;
  border-radius:var(--radius);
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}
</style>
</head>

<body>

<div class="calculator">

<h1>Smart Home Security Cost Estimator</h1>

<!-- SYSTEM -->
<div class="section card-box">
<h2>Security System</h2>
<div class="grid">
  <div><label>System Package</label><select id="tier"></select></div>
  <div><label>Installation</label><select id="install"></select></div>
  <div><label>Monitoring Plan</label><select id="monitoring"></select></div>
</div>
</div>

<!-- DEVICES -->
<div class="section card-box">
<h2>Security Devices</h2>
<div class="grid">
  <div><label>Indoor Cameras</label><input id="indoorCam" type="number" value="0" min="0"></div>
  <div><label>Outdoor Cameras</label><input id="outdoorCam" type="number" value="0" min="0"></div>
  <div><label>Video Doorbells</label><input id="doorbell" type="number" value="0" min="0"></div>
  <div><label>Smart Locks</label><input id="lock" type="number" value="0" min="0"></div>
  <div><label>Door Sensors</label><input id="doorSensor" type="number" value="0" min="0"></div>
  <div><label>Window Sensors</label><input id="windowSensor" type="number" value="0" min="0"></div>
  <div><label>Motion Sensors</label><input id="motion" type="number" value="0" min="0"></div>
  <div><label>Glass Break Sensors</label><input id="glass" type="number" value="0" min="0"></div>
  <div><label>Smoke / CO Detectors</label><input id="smoke" type="number" value="0" min="0"></div>
  <div><label>Water Leak Sensors</label><input id="water" type="number" value="0" min="0"></div>
  <div><label>Keypads</label><input id="keypad" type="number" value="0" min="0"></div>
  <div><label>Sirens</label><input id="siren" type="number" value="0" min="0"></div>
</div>
</div>

<!-- TOTALS -->
<div class="totals card-box">
  <div class="total-box">
    <div>Upfront:</div> <div class="total-value" id="upfront">$0</div>
  </div>
  <div class="total-box">
    <div>Monthly:</div> <div class="total-value" id="monthly">$0</div>
  </div>
  <div class="device-summary" id="device-summary">No devices selected</div>
</div>

<button id="submitBtn">Get My Security Quote</button>

</div>

<script>
// ===== CATALOG =====
const catalog = {
  tiers: [
    { id:"basic", name:"Basic Alarm System", price:499 },
    { id:"standard", name:"Smart Home Security", price:899 },
    { id:"premium", name:"Advanced AI Security", price:1499 }
  ],
  install: [
    { id:"standard", name:"Standard Install", cost:299 },
    { id:"advanced", name:"Advanced Install", cost:499 }
  ],
  monitoring: [
    { id:"self", name:"Self-Monitoring", monthly:0 },
    { id:"pro", name:"24/7 Professional Monitoring", monthly:39 },
    { id:"video", name:"Pro + Video Verification", monthly:49 },
    { id:"guard", name:"Pro + Guard Response", monthly:69 },
    { id:"fire", name:"Pro + Fire & CO Monitoring", monthly:59 }
  ],
  devices: {
    indoorCam:129,
    outdoorCam:199,
    doorbell:179,
    lock:249,
    doorSensor:39,
    windowSensor:39,
    motion:59,
    glass:79,
    smoke:89,
    water:69,
    keypad:99,
    siren:119
  }
};

// ===== FILL SELECTS =====
function fill(id,list,label){
  const el=document.getElementById(id);
  list.forEach(o=>{
    const opt=document.createElement("option");
    opt.value=o.id;
    opt.textContent=label(o);
    el.appendChild(opt);
  });
}

fill("tier",catalog.tiers,o=>o.name);
fill("install",catalog.install,o=>o.name);
fill("monitoring",catalog.monitoring,o=>`${o.name} ($${o.monthly}/mo)`);

// ===== CALC & LIVE ANIMATION =====
function calc(){
  const tierSel=catalog.tiers.find(x=>x.id===document.getElementById("tier").value);
  const instSel=catalog.install.find(x=>x.id===document.getElementById("install").value);
  const monSel=catalog.monitoring.find(x=>x.id===document.getElementById("monitoring").value);

  let upfront = tierSel.price + instSel.cost;
  let monthly = monSel.monthly;

  const summary = [];
  Object.keys(catalog.devices).forEach(k=>{
    const qty = Number(document.getElementById(k).value)||0;
    if(qty>0){
      upfront += qty*catalog.devices[k];
      summary.push(`${qty} x ${k}`);
    }
  });

  window.calcData = {upfront,monthly};

  // Animate numbers
  animateValue(document.getElementById("upfront"), window.calcData.prevUpfront||0, upfront, 400);
  animateValue(document.getElementById("monthly"), window.calcData.prevMonthly||0, monthly, 400);

  window.calcData.prevUpfront = upfront;
  window.calcData.prevMonthly = monthly;

  document.getElementById("device-summary").textContent = summary.length? summary.join(", ") : "No devices selected";
}

// Simple animation for totals
function animateValue(el, start, end, duration) {
  let startTime = null;
  const step = timestamp => {
    if (!startTime) startTime = timestamp;
    const progress = Math.min((timestamp - startTime)/duration,1);
    el.textContent = `$${Math.round(start + (end-start)*progress)}` + (el.id==="monthly" ? "/mo" : "");
    if(progress<1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

// ===== EVENT LISTENERS =====
document.querySelectorAll("select,input").forEach(e=>e.addEventListener("input",calc));
calc();

// ===== HUBSPOT & RESULTS SUBMIT =====
document.getElementById("submitBtn").addEventListener("click", function(){
  const leadData = {
    tier: document.getElementById("tier").value,
    install: document.getElementById("install").value,
    monitoring: document.getElementById("monitoring").value,
    devices: Object.keys(catalog.devices).reduce((acc,k)=>{
      acc[k] = Number(document.getElementById(k).value)||0;
      return acc;
    }, {}),
    upfront: window.calcData.upfront,
    monthly: window.calcData.monthly
  };

  // Store for results page
  sessionStorage.setItem("calcData", JSON.stringify(leadData));

  // Optional: send to HubSpot endpoint (define window.netlifyHubspotEndpoint in Netlify)
  if(window.netlifyHubspotEndpoint){
    fetch(window.netlifyHubspotEndpoint,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify(leadData)
    }).catch(console.error);
  }

  window.location.href = "results.html";
});
</script>

</body>
</html>
