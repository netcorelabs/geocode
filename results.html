<script>
document.addEventListener("DOMContentLoaded", function () {

  const calcData = JSON.parse(sessionStorage.getItem("calc_data") || "{}");

  document.getElementById("upfront").textContent =
    "$" + Math.round(calcData.upfront || 0) + " Upfront";

  document.getElementById("monthly").textContent =
    "$" + (calcData.monthly || 0) + "/month";

  document.getElementById("device-summary").textContent =
    calcData.summary && calcData.summary.length
      ? calcData.summary.join(", ")
      : "No devices selected";

  const address =
    calcData.address ||
    "1600 Amphitheatre Parkway, Mountain View, CA";

  function loadGoogleMaps() {
    const script = document.createElement("script");
    script.src =
      "https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_KEY&libraries=visualization&callback=initMap";
    script.async = true;
    script.defer = true;
    document.head.appendChild(script);
  }

  window.initMap = function () {
    const geocoder = new google.maps.Geocoder();

    geocoder.geocode({ address: address }, function (results, status) {
      if (status !== "OK" || !results[0]) {
        document.getElementById("map").textContent =
          "Unable to load map for this address";
        return;
      }

      const loc = results[0].geometry.location;

      const map = new google.maps.Map(
        document.getElementById("map"),
        {
          zoom: 14,
          center: loc,
        }
      );

      new google.maps.Marker({
        position: loc,
        map: map,
      });
    });
  };

  loadGoogleMaps();

});
</script>
